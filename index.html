<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Free PDF Editor — Merge, Split, Compress & Convert PDFs Online (No Uploads)</title>
  <meta name="description" content="Free online PDF tools to merge, split, compress, and convert PDFs to JPG/PNG. Works privately in your browser—no file uploads, no signup."/>
  <meta name="robots" content="index,follow,max-image-preview:large"/>
  <link rel="canonical" href="https://YOURDOMAIN.com/"/><!-- TODO: set your canonical -->

  <!-- Social / Open Graph -->
  <meta property="og:site_name" content="Free PDF Tools"/>
  <meta property="og:type" content="website"/>
  <meta property="og:title" content="Free PDF Editor — Merge, Split, Compress & Convert"/>
  <meta property="og:description" content="Fast, private, in-browser PDF tools. Merge, split, compress, and convert to images without uploading files."/>
  <meta property="og:url" content="https://YOURDOMAIN.com/"/>
  <meta property="og:image" content="https://YOURDOMAIN.com/og-image.jpg"/>
  <meta name="twitter:card" content="summary_large_image"/>

  <!-- Fonts & performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="dns-prefetch" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">

  <!-- Core libs (deferred for faster paint) -->
  <script defer src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.min.js"></script>
  <script defer>window.addEventListener('DOMContentLoaded',()=>{ pdfjsLib.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.worker.min.js"; });</script>
  <!-- ZIP lib for images -->
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

  <style>
    :root{
      --bg:#0b0f14; --panel:#111825; --ink:#eaf2ff; --muted:#9bb3d1;
      --brand:#3b82f6; --brand-2:#22d3ee; --border:#1e293b; --ok:#22c55e; --warn:#f59e0b;
    }
    @media (prefers-color-scheme: light){
      :root{ --bg:#f5f7fb; --panel:#ffffff; --ink:#0f172a; --muted:#4b5563; --border:#e5e7eb; --brand:#2563eb; }
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Arial; color:var(--ink);
      background: radial-gradient(1200px 600px at 10% -10%, #0ea5e92a, transparent 60%),
                  radial-gradient(1000px 500px at 100% 0%, #6366f12a, transparent 60%),
                  var(--bg);
      padding-top:72px;
    }
    a{color:inherit}
    .sticky{ position:fixed; top:0; left:0; right:0; z-index:50; background:rgba(17,24,37,.9); backdrop-filter: blur(8px); border-bottom:1px solid var(--border) }
    .sticky .wrap{ max-width:980px; margin:0 auto; padding:10px 12px; display:flex; gap:8px; align-items:center }
    .brand{display:flex; align-items:center; gap:10px; margin-right:auto}
    .logo{width:28px; height:28px; border-radius:8px; background: linear-gradient(135deg, var(--brand), var(--brand-2)); color:#fff; display:grid; place-items:center; font-weight:800; font-size:12px}
    .brand span{font-weight:700}
    .sbtn{background:var(--brand); color:#fff; border:0; padding:8px 10px; border-radius:10px; font-weight:700; cursor:pointer}
    .sbtn.alt{background:#111827; color:#e5e7eb; border:1px solid var(--border)}

    .container{max-width:980px; margin:28px auto; padding:16px}
    header{display:flex; align-items:center; gap:14px; justify-content:center; margin-bottom:10px}
    .logo-lg{width:40px; height:40px; border-radius:10px; background: linear-gradient(135deg, var(--brand), var(--brand-2)); display:grid; place-items:center; color:white; font-weight:800; box-shadow:0 8px 30px #00000033}
    h1{margin:0; font-size:clamp(22px,3.6vw,34px)}
    .sub{color:var(--muted); text-align:center; margin:6px 0 12px}

    .adwrap{display:flex; justify-content:center; margin:12px 0}
    .adsbygoogle{display:block}
    .adwrap.hidden{display:none}

    .tabs{display:flex; gap:8px; flex-wrap:wrap; margin:18px auto 12px; justify-content:center}
    .tab{border:1px solid var(--border); background:var(--panel); padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:600}
    .tab.active{outline:2px solid var(--brand)}

    .tabs .tab{ color:#ffffff !important; }
    @media (prefers-color-scheme: light){ .tabs .tab{ color:#0f172a !important; } }
    .tabs .tab:disabled{ color:rgba(255,255,255,.6) !important; }
    .tabs .tab.active{
      background:var(--brand) !important;
      color:#ffffff !important;
      box-shadow:0 0 10px rgba(59,130,246,.7);
      outline:none;
    }

    .panel{background:var(--panel); border:1px solid var(--border); border-radius:18px; padding:18px; box-shadow:0 10px 30px #00000014}
    .grid{display:grid; grid-template-columns:1fr 1fr; gap:18px}
    @media (max-width:820px){ .grid{grid-template-columns:1fr} }

    .drop{border:2px dashed var(--border); border-radius:14px; padding:22px; display:grid; place-items:center; text-align:center; min-height:160px}
    .drop.drag{border-color:var(--brand); background:linear-gradient(180deg, #3b82f60e, #0000)}
    .drop input{display:none}
    .btn{background:var(--brand); color:white; border:0; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:700}
    .btn.secondary{ background:#111827; color:#e5e7eb; border:1px solid var(--border)}
    .actions{display:flex; gap:10px; justify-content:center; margin-top:12px; flex-wrap:wrap}
    .hint{color:var(--muted); font-size:13px; text-align:center}
    ul.files{list-style:none; margin:12px 0 0; padding:0; max-height:260px; overflow:auto}
    ul.files li{display:flex; align-items:center; justify-content:space-between; gap:10px; padding:8px 10px; border:1px dashed var(--border); border-radius:10px; margin-bottom:8px; font-size:14px; background:#0f172a22}
    .pill{font-size:12px; color:#cbd5e1; padding:2px 8px; border-radius:999px; background:#0f172a; border:1px solid var(--border)}
    ul.files li[draggable="true"]{cursor:grab}
    ul.files li.dragging{opacity:.5}
    ul.files li.drop-hint{outline:2px dashed var(--brand)}
    .controls{display:flex; gap:6px; margin-left:auto}
    .iconbtn{border:1px solid var(--border); background:#0f172a; color:#e5e7eb; padding:4px 8px; border-radius:8px; cursor:pointer}
    .thumb{display:flex; align-items:center; gap:10px}
    .thumb canvas{width:40px; height:auto; border:1px solid var(--border); border-radius:6px; background:#00000022}

    footer{color:var(--muted); text-align:center; margin:18px 0}
    .tiny{font-size:12px}

    .toast{position:fixed; right:16px; bottom:16px; background:var(--panel); border:1px solid var(--border); padding:10px 12px; border-radius:10px; opacity:0; transform:translateY(10px); transition:.2s}
    .toast.show{opacity:1; transform:translateY(0)}
    .spinner { width:18px; height:18px; border:3px solid #ffffff66; border-top-color:white; border-radius:50%; animation:spin 0.8s linear infinite; display:inline-block; vertical-align:-3px; margin-right:8px }
    @keyframes spin{to{transform:rotate(360deg)}}

    .cookie{
      position:fixed; left:16px; right:16px; bottom:16px; z-index:60; background:var(--panel);
      border:1px solid var(--border); border-radius:12px; padding:14px; display:none;
      box-shadow:0 10px 30px #00000033;
    }
    .cookie.show{display:block}
    .cookie .row{display:flex; gap:8px; justify-content:flex-end; margin-top:10px; flex-wrap:wrap}

    .progress{height:10px; width:100%; background:#0f172a44; border-radius:999px; overflow:hidden; border:1px solid var(--border); margin-top:10px}
    .progress > div{height:100%; width:0; background:linear-gradient(90deg, var(--brand), var(--brand-2)); transition:width .2s ease}
    .progress-wrap{margin-top:8px}
    .row-slim{display:flex; align-items:center; justify-content:space-between; gap:10px}
    .kbd{font:600 12px/1 Inter,system-ui; padding:2px 6px; border:1px solid var(--border); border-bottom-width:2px; border-radius:6px; background:#0f172a22}

    /* SEO helper blocks */
    .seo { margin:14px 0 0; color:var(--muted); font-size:14px; line-height:1.5 }
    .seo h2, .seo h3 { color:var(--ink); margin:.4rem 0 .2rem; font-size: clamp(18px, 2.5vw, 20px); }
    .faq details { background:#0f172a1a; border:1px solid var(--border); border-radius:10px; padding:10px 12px; margin:8px 0; }
    .faq summary { cursor:pointer; font-weight:600; }
  </style>
</head>
<body>
  <!-- Sticky CTA Bar -->
  <div class="sticky" role="navigation" aria-label="Quick actions">
    <div class="wrap">
      <a class="brand" href="/" aria-label="Free PDF Tools Home">
        <div class="logo" aria-hidden="true">PDF</div><span>Free PDF Tools</span>
      </a>
      <div class="cta">
        <button class="sbtn" data-goto="merge" data-pick="mergeFiles" aria-label="Go to Merge PDF">Merge</button>
        <button class="sbtn alt" data-goto="split" data-pick="splitFile" aria-label="Go to Split PDF">Split</button>
        <button class="sbtn alt" data-goto="compress" data-pick="compressFile" aria-label="Go to Compress PDF">Compress</button>
        <button class="sbtn alt" data-goto="images" data-pick="pdfToImgFile" aria-label="Go to PDF to Images">PDF → Images</button>
      </div>
    </div>
  </div>

  <div class="container">
    <header>
      <div class="logo-lg" aria-hidden="true">PDF</div>
      <h1>Free PDF Merge, Split & Convert</h1>
    </header>
    <p class="sub">Fast, private, in-browser tools to merge, split, compress, and convert PDFs. No signup.</p>

    <!-- Top Ad (consent-gated) -->
    <div class="adwrap hidden" id="ad-top">
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="YOUR-ADSENSE-CLIENT-ID"  <!-- TODO -->
           data-ad-slot="YOUR-AD-SLOT-ID"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
    </div>

    <nav class="tabs" id="tabs" aria-label="PDF tools">
      <button class="tab active" data-tab="merge">Merge</button>
      <button class="tab" data-tab="split">Split</button>
      <button class="tab" data-tab="compress">Compress</button>
      <button class="tab" data-tab="images">PDF → Images</button>
    </nav>

    <!-- MERGE -->
    <section class="panel" data-panel="merge" id="merge">
      <h2 style="margin-top:0">Merge PDF Files Online</h2>
      <div class="grid">
        <div>
          <label class="drop" id="mergeDrop" aria-label="Drop PDFs to merge">
            <input type="file" id="mergeFiles" multiple accept="application/pdf" aria-label="Choose PDFs to merge">
            <div><strong>Drop PDFs here</strong><br/>or <button type="button" class="btn secondary" id="mergePick">Choose Files</button><div class="hint">Add 2+ PDFs, then drag or use ▲▼ to reorder</div></div>
          </label>
          <div class="row-slim">
            <label><input type="checkbox" id="mergeCompressChk"> Compress merged file</label>
            <span class="kbd" title="Paste files from clipboard">Tip: Ctrl/Cmd+V to paste files</span>
          </div>
          <div class="progress-wrap"><div class="progress" id="mergeProg" hidden><div></div></div></div>
        </div>
        <div>
          <ul class="files" id="mergeList" aria-live="polite"></ul>
          <div class="actions">
            <button class="btn" id="mergeBtn">Merge & Download</button>
            <button class="btn secondary" id="mergeClear">Clear</button>
          </div>
          <p class="hint tiny">Previews show the first page of each PDF.</p>
        </div>
      </div>
      <div class="seo">
        <p>Use our free PDF merger to quickly combine multiple PDF files into a single document. Everything runs locally in your browser—your files never leave your device. Reorder pages before export and optionally apply light compression to reduce file size.</p>
      </div>
    </section>

    <!-- Mid-page Ad -->
    <div class="adwrap hidden" id="ad-mid">
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="YOUR-ADSENSE-CLIENT-ID"
           data-ad-slot="YOUR-AD-SLOT-ID"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
    </div>

    <!-- SPLIT -->
    <section class="panel" data-panel="split" id="split" hidden>
      <h2 style="margin-top:0">Split PDF Into Pages or Ranges</h2>
      <div class="grid">
        <div>
          <label class="drop" id="splitDrop" aria-label="Drop a PDF to split">
            <input type="file" id="splitFile" accept="application/pdf" aria-label="Choose a PDF to split">
            <div><strong>Drop a PDF here</strong><br/>or <button type="button" class="btn secondary" id="splitPick">Choose File</button><div class="hint">Examples: 1-3, 5-5, 7-10</div></div>
          </label>
          <div class="progress-wrap"><div class="progress" id="splitProg" hidden><div></div></div></div>
        </div>
        <div>
          <ul class="files" id="splitList"></ul>
          <label for="pageRange" class="tiny">Enter page range</label>
          <input type="text" id="pageRange" placeholder="e.g., 1-3" />
          <div class="actions">
            <button class="btn" id="splitBtn">Split & Download</button>
            <button class="btn secondary" id="splitClear">Clear</button>
          </div>
        </div>
      </div>
      <div class="seo">
        <p>Extract specific pages or a continuous page range from a PDF. Enter a range like “1–3” to save only those pages into a new file. Processing happens on your device for speed and privacy.</p>
      </div>
    </section>

    <!-- COMPRESS -->
    <section class="panel" data-panel="compress" id="compress" hidden>
      <h2 style="margin-top:0">Compress PDF (Light, Lossless Pass)</h2>
      <div class="grid">
        <div>
          <label class="drop" id="compressDrop" aria-label="Drop a PDF to compress">
            <input type="file" id="compressFile" accept="application/pdf" aria-label="Choose a PDF to compress">
            <div><strong>Drop a PDF here</strong><br/>or <button type="button" class="btn secondary" id="compressPick">Choose File</button><div class="hint">Light, lossless compression (re-encoding later)</div></div>
          </label>
          <div class="progress-wrap"><div class="progress" id="compressProg" hidden><div></div></div></div>
        </div>
        <div>
          <ul class="files" id="compressList"></ul>
          <div class="actions">
            <button class="btn" id="compressBtn">Compress & Download</button>
            <button class="btn secondary" id="compressClear">Clear</button>
          </div>
        </div>
      </div>
      <div class="seo">
        <p>Reduce PDF size for easier sharing while preserving layout. Our lightweight pass optimizes objects and streams. For heavy image downsampling, export to images and re-assemble if needed.</p>
      </div>
    </section>

    <!-- PDF TO IMAGES -->
    <section class="panel" data-panel="images" id="images" hidden>
      <h2 style="margin-top:0">Convert PDF to JPG or PNG</h2>
      <div class="grid">
        <div>
          <label class="drop" id="imgDrop" aria-label="Drop a PDF to convert to images">
            <input type="file" id="pdfToImgFile" accept="application/pdf" aria-label="Choose a PDF to convert to images">
            <div><strong>Drop a PDF here</strong><br/>or <button type="button" class="btn secondary" id="imgPick">Choose File</button><div class="hint">Choose output below</div></div>
          </label>
          <div class="progress-wrap"><div class="progress" id="imgProg" hidden><div></div></div></div>
        </div>
        <div>
          <ul class="files" id="imgList"></ul>
          <div class="row-slim" style="margin:8px 0">
            <label>Format:
              <select id="imgFormat" aria-label="Choose image format">
                <option value="image/jpeg" selected>JPG</option>
                <option value="image/png">PNG</option>
              </select>
            </label>
            <label id="jpgQWrap">JPG quality:
              <input type="range" id="jpgQuality" min="60" max="100" step="1" value="92" aria-label="JPG quality">
              <span class="kbd" id="jpgQLabel">92%</span>
            </label>
          </div>
          <div class="actions">
            <button class="btn" id="imgBtn">Convert & Download Individually</button>
            <button class="btn secondary" id="imgZipBtn">Convert & Download ZIP</button>
            <button class="btn secondary" id="imgClear">Clear</button>
          </div>
        </div>
      </div>
      <div class="seo">
        <p>Turn any PDF page into high-resolution JPG or PNG images. Adjust JPEG quality for smaller downloads, or export all pages at once as a single ZIP file.</p>
      </div>
    </section>

    <!-- FAQ block (visible + enhances EEAT) -->
    <section class="panel faq" id="faq" style="margin-top:18px">
      <h2 style="margin-top:0">PDF Tool FAQs</h2>
      <details>
        <summary>Do you upload or store my files?</summary>
        <p>No. All processing happens in your browser using JavaScript. Your PDFs never leave your device.</p>
      </details>
      <details>
        <summary>Is this PDF editor free?</summary>
        <p>Yes. The core tools (merge, split, compress, convert) are free to use with no signup.</p>
      </details>
      <details>
        <summary>Which platforms are supported?</summary>
        <p>It runs in any modern browser on Windows, macOS, Linux, and ChromeOS.</p>
      </details>
    </section>

    <footer>
      <nav class="tiny" aria-label="Footer">
        <a href="#merge">Merge PDF</a> ·
        <a href="#split">Split PDF</a> ·
        <a href="#compress">Compress PDF</a> ·
        <a href="#images">PDF to JPG/PNG</a> ·
        <a href="#faq">FAQ</a> ·
        <a href="privacy.html">Privacy</a>
      </nav>
      <div class="tiny">Files stay in your browser.</div>
    </footer>
  </div>

  <!-- Cookie/Consent Banner -->
  <div class="cookie" id="cookie" role="dialog" aria-live="polite" aria-label="Privacy choices">
    <div><strong>Privacy choices:</strong> We use cookies for ads/analytics. Your PDFs never leave your browser.</div>
    <div class="row">
      <button class="btn secondary" id="cookie-decline">Decline</button>
      <button class="btn" id="cookie-accept">Accept</button>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <!-- App logic (kept last so defers can load first) -->
  <script>
    // ===== Helpers =====
    const $ = s => document.querySelector(s), $$ = s => document.querySelectorAll(s);
    const toast = (m)=>{ const t=$('#toast'); t.textContent=m; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),2200); };
    const formatSize = b => (b/1024/1024).toFixed(2)+' MB';
    const setBusy = (btn, busy=true, label) => { if(busy){ btn.disabled=true; btn.dataset._label=btn.textContent; btn.innerHTML=`<span class="spinner"></span>${label||'Working…'}` } else { btn.disabled=false; btn.textContent=btn.dataset._label||'Done'; } };
    const setProgress = (wrap, pct=null)=>{ const bar=wrap?.querySelector('div'); if(!wrap) return; if(pct===null){ wrap.hidden=true; bar.style.width='0%'; } else { wrap.hidden=false; bar.style.width=pct+'%'; } };

    // Tabs
    $('#tabs').addEventListener('click', e=>{
      if(!e.target.classList.contains('tab')) return;
      $$('.tab').forEach(t=>t.classList.remove('active')); e.target.classList.add('active');
      const id = e.target.dataset.tab; $$('section.panel').forEach(p=>p.hidden = p.dataset.panel !== id);
      // Update hash for anchorable URLs
      if(history.pushState){ history.pushState(null,'','#'+id); } else { location.hash = id; }
    });
    // Load panel from hash on first visit
    window.addEventListener('DOMContentLoaded', ()=>{
      const hash = (location.hash||'').replace('#','');
      const target = hash && document.querySelector(`.tab[data-tab="${hash}"]`);
      if(target){ target.click(); }
    });

    // Sticky quick actions
    document.querySelector('.sticky').addEventListener('click', (e)=>{
      const btn = e.target.closest('[data-goto]'); if(!btn) return;
      const tab = btn.dataset.goto, pick = btn.dataset.pick;
      const targetTab = [...$$('.tab')].find(t=>t.dataset.tab===tab);
      targetTab?.click();
      if (pick) setTimeout(()=> document.getElementById(pick)?.click(), 50);
    });

    // Drag & Drop / File listing with thumbnails
    const listWithThumbs = async (ul, files, firstPageOnly=true) => {
      ul.innerHTML='';
      for(const f of files){
        const li=document.createElement('li');
        li.innerHTML = `
          <div class="thumb"><canvas aria-hidden="true"></canvas><span class="name">${f.name}</span></div>
          <div class="controls">
            <button class="iconbtn" data-up aria-label="Move up">▲</button>
            <button class="iconbtn" data-down aria-label="Move down">▼</button>
            <span class="pill" aria-label="File size">${formatSize(f.size)}</span>
          </div>`;
        ul.appendChild(li);
        try{
          const buf = await f.arrayBuffer();
          const pdf = await pdfjsLib.getDocument(new Uint8Array(buf)).promise;
          const page = await pdf.getPage(1);
          const vp = page.getViewport({scale:0.3});
          const canvas = li.querySelector('canvas');
          canvas.width = vp.width; canvas.height = vp.height;
          await page.render({canvasContext:canvas.getContext('2d'), viewport:vp}).promise;
        }catch(err){ /* ignore non-renderable */ }
      }
    };

    const hookDrop = (wrap, input, onFiles) => {
      wrap.addEventListener('dragover', e=>{ e.preventDefault(); wrap.classList.add('drag'); });
      ['dragleave','drop'].forEach(ev => wrap.addEventListener(ev, _=>wrap.classList.remove('drag')));
      wrap.addEventListener('drop', e=>{ e.preventDefault(); onFiles(e.dataTransfer.files); });
      input.addEventListener('change', ()=> onFiles(input.files));
    };

    // Merge
    const mergeDrop=$('#mergeDrop'), mergePick=$('#mergePick'), mergeInput=$('#mergeFiles'), mergeList=$('#mergeList');
    let mergeFilesArr = [];
    const renderMergeList = async ()=>{ await listWithThumbs(mergeList, mergeFilesArr);
      [...mergeList.children].forEach((li, idx)=>{
        li.draggable = true; li.dataset.index = idx;
        li.addEventListener('dragstart', ()=> li.classList.add('dragging'));
        li.addEventListener('dragend', ()=>{ li.classList.remove('dragging'); $$('ul.files li').forEach(n=>n.classList.remove('drop-hint')); });
        li.addEventListener('dragover', e=>{ e.preventDefault(); li.classList.add('drop-hint'); });
        li.addEventListener('dragleave', ()=> li.classList.remove('drop-hint'));
        li.addEventListener('drop', e=>{
          e.preventDefault();
          const from = parseInt(mergeList.querySelector('li.dragging')?.dataset.index,10);
          const to = parseInt(li.dataset.index,10);
          if(isNaN(from)||isNaN(to)||from===to) return;
          const item = mergeFilesArr.splice(from,1)[0]; mergeFilesArr.splice(to,0,item); renderMergeList();
        });
        li.querySelector('[data-up]').onclick = ()=>{ if(idx>0){ const x=mergeFilesArr.splice(idx,1)[0]; mergeFilesArr.splice(idx-1,0,x); renderMergeList(); } };
        li.querySelector('[data-down]').onclick = ()=>{ if(idx<mergeFilesArr.length-1){ const x=mergeFilesArr.splice(idx,1)[0]; mergeFilesArr.splice(idx+1,0,x); renderMergeList(); } };
      });
    };
    mergePick.onclick=()=>mergeInput.click();
    hookDrop(mergeDrop, mergeInput, files=>{ mergeFilesArr = [...files]; renderMergeList(); });

    document.addEventListener('paste', e=>{
      if(!e.clipboardData?.files?.length) return;
      const files = [...e.clipboardData.files].filter(f=>/pdf$/i.test(f.name) || f.type==='application/pdf');
      if(!files.length) return;
      mergeFilesArr = mergeFilesArr.concat(files);
      renderMergeList(); toast(`Added ${files.length} file(s) from clipboard`);
    });

    $('#mergeClear').onclick=()=>{ mergeFilesArr=[]; mergeInput.value=''; mergeList.innerHTML=''; };
    $('#mergeBtn').onclick=async ()=>{
      if(mergeFilesArr.length<2) return toast('Add at least two PDFs.');
      const btn=$('#mergeBtn'); setBusy(btn,true,'Merging…'); const prog=$('#mergeProg'); setProgress(prog, 5);
      try{
        const merged=await PDFLib.PDFDocument.create();
        for (let i=0;i<mergeFilesArr.length;i++){
          const f=mergeFilesArr[i]; const ab=await f.arrayBuffer(); const src=await PDFLib.PDFDocument.load(ab);
          const pages=await merged.copyPages(src, src.getPageIndices()); pages.forEach(p=>merged.addPage(p));
          setProgress(prog, Math.min(95, Math.round(((i+1)/mergeFilesArr.length)*90)+5));
        }
        let bytes=await merged.save(); setProgress(prog, 98);
        if($('#mergeCompressChk').checked){
          const temp = await PDFLib.PDFDocument.load(bytes);
          bytes = await temp.save({useObjectStreams:true});
        }
        const blob=new Blob([bytes],{type:'application/pdf'});
        const a=Object.assign(document.createElement('a'),{href:URL.createObjectURL(blob),download:'merged.pdf'});
        document.body.appendChild(a); a.click(); URL.revokeObjectURL(a.href); a.remove();
        setProgress(prog, null); toast('Merged PDF downloaded.');
      }catch(e){ console.error(e); toast('Merge failed.'); setProgress($('#mergeProg'), null); }
      finally{ setBusy(btn,false); }
    };

    // Split
    const splitDrop=$('#splitDrop'), splitPick=$('#splitPick'), splitInput=$('#splitFile'), splitList=$('#splitList');
    const listFiles = (ul, files)=>{ ul.innerHTML=''; [...files].forEach(f=>{ const li=document.createElement('li'); li.innerHTML=`<div class="thumb"><canvas aria-hidden="true"></canvas><span>${f.name}</span></div><span class="pill">${formatSize(f.size)}</span>`; ul.appendChild(li); renderThumbTo(li.querySelector('canvas'), f).catch(()=>{}); }); };
    async function renderThumbTo(canvas, file){
      const buf = await file.arrayBuffer();
      const pdf = await pdfjsLib.getDocument(new Uint8Array(buf)).promise;
      const page = await pdf.getPage(1);
      const vp = page.getViewport({scale:0.3});
      canvas.width = vp.width; canvas.height = vp.height;
      await page.render({canvasContext:canvas.getContext('2d'), viewport:vp}).promise;
    }
    splitPick.onclick=()=>splitInput.click();
    hookDrop(splitDrop, splitInput, files=>{ splitInput.files = files; listFiles(splitList, files); });
    $('#splitClear').onclick=()=>{ splitInput.value=''; splitList.innerHTML=''; $('#pageRange').value=''; };
    $('#splitBtn').onclick=async ()=>{
      const file=splitInput.files[0]; const range=$('#pageRange').value.trim();
      if(!file) return toast('Choose a PDF.'); if(!/^\d+\s*-\s*\d+$/.test(range)) return toast('Enter a valid range like 1-3.');
      const btn=$('#splitBtn'); setBusy(btn,true,'Splitting…'); const prog=$('#splitProg'); setProgress(prog, 10);
      try{
        const [s,e]=range.split('-').map(n=>parseInt(n.trim(),10)-1);
        const ab=await file.arrayBuffer(); const src=await PDFLib.PDFDocument.load(ab);
        if(s<0||e>=src.getPageCount()||s>e) throw new Error('range');
        const out=await PDFLib.PDFDocument.create(); const pages=await out.copyPages(src, Array.from({length:e-s+1},(_,i)=>s+i)); pages.forEach(p=>out.addPage(p));
        const bytes=await out.save(); setProgress(prog, 95);
        const blob=new Blob([bytes],{type:'application/pdf'}); const a=Object.assign(document.createElement('a'),{href:URL.createObjectURL(blob),download:`split-${s+1}-${e+1}.pdf`}); document.body.appendChild(a); a.click(); URL.revokeObjectURL(a.href); a.remove();
        setProgress(prog, null); toast('Split PDF downloaded.');
      }catch(e){ console.error(e); toast('Split failed.'); setProgress($('#splitProg'), null); }
      finally{ setBusy(btn,false); }
    };

    // Compress
    const compressDrop=$('#compressDrop'), compressPick=$('#compressPick'), compressInput=$('#compressFile'), compressList=$('#compressList']);
    compressPick.onclick=()=>compressInput.click();
    hookDrop(compressDrop, compressInput, files=>{ compressInput.files = files; listFiles(compressList, files); });
    $('#compressClear').onclick=()=>{ compressInput.value=''; compressList.innerHTML=''; };
    $('#compressBtn').onclick=async ()=>{
      const file=compressInput.files[0]; if(!file) return toast('Choose a PDF.');
      const btn=$('#compressBtn'); setBusy(btn,true,'Compressing…'); const prog=$('#compressProg'); setProgress(prog, 20);
      try{
        const ab=await file.arrayBuffer(); const pdf=await PDFLib.PDFDocument.load(ab);
        const bytes=await pdf.save({useObjectStreams:true}); setProgress(prog, 95);
        const blob=new Blob([bytes],{type:'application/pdf'}); const a=Object.assign(document.createElement('a'),{href:URL.createObjectURL(blob),download:`compressed-${file.name}`}); document.body.appendChild(a); a.click(); URL.revokeObjectURL(a.href); a.remove();
        setProgress(prog, null); toast('Compressed PDF downloaded.');
      }catch(e){ console.error(e); toast('Compression failed.'); setProgress($('#compressProg'), null); }
      finally{ setBusy(btn,false); }
    };

    // PDF -> Images
    const imgDrop=$('#imgDrop'), imgPick=$('#imgPick'), imgInput=$('#pdfToImgFile'), imgList=$('#imgList');
    const fmtSel = $('#imgFormat'); const jpgQ = $('#jpgQuality'); const jpgQLabel = $('#jpgQLabel'); const jpgQWrap = $('#jpgQWrap');
    fmtSel.addEventListener('change', ()=>{
      const jpg = fmtSel.value==='image/jpeg';
      jpgQWrap.style.display = jpg ? 'inline-block' : 'none';
    }); fmtSel.dispatchEvent(new Event('change'));
    jpgQ.addEventListener('input', ()=> jpgQLabel.textContent = jpgQ.value+'%');

    imgPick.onclick=()=>imgInput.click();
    hookDrop(imgDrop, imgInput, files=>{ imgInput.files = files; listFiles(imgList, files); });
    $('#imgClear').onclick=()=>{ imgInput.value=''; imgList.innerHTML=''; };

    async function pdfToImagesCommon(file, onPageBlob, onProgress){
      const ab=await file.arrayBuffer(); const typed=new Uint8Array(ab);
      const pdf=await pdfjsLib.getDocument(typed).promise;
      for(let i=1;i<=pdf.numPages;i++){
        const page=await pdf.getPage(i); const viewport=page.getViewport({scale:2});
        const canvas=document.createElement('canvas'); const ctx=canvas.getContext('2d');
        canvas.width=viewport.width; canvas.height=viewport.height;
        await page.render({canvasContext:ctx, viewport}).promise;
        const mime = fmtSel.value;
        const q = mime==='image/jpeg' ? Number(jpgQ.value)/100 : undefined;
        const blob = await new Promise(res=>canvas.toBlob(b=>res(b), mime, q));
        await onPageBlob(i, blob);
        onProgress?.(Math.round((i/pdf.numPages)*100));
      }
      return pdf.numPages;
    }

    $('#imgBtn').onclick=async ()=>{
      const file=imgInput.files[0]; if(!file) return toast('Choose a PDF.');
      const btn=$('#imgBtn'); setBusy(btn,true,'Converting…'); const prog=$('#imgProg'); setProgress(prog, 1);
      try{
        await pdfToImagesCommon(file, async (i, blob)=>{
          const a=Object.assign(document.createElement('a'),{href:URL.createObjectURL(blob),download:`page-${i}.${fmtSel.value==='image/png'?'png':'jpg'}`});
          document.body.appendChild(a); a.click(); URL.revokeObjectURL(a.href); a.remove();
        }, pct=> setProgress(prog, pct));
        setProgress(prog, null); toast('Images downloaded.');
      }catch(e){ console.error(e); toast('Conversion failed.'); setProgress($('#imgProg'), null); }
      finally{ setBusy(btn,false); }
    };

    $('#imgZipBtn').onclick=async ()=>{
      const file=imgInput.files[0]; if(!file) return toast('Choose a PDF.');
      const btn=$('#imgZipBtn'); setBusy(btn,true,'Zipping…'); const prog=$('#imgProg'); setProgress(prog, 1);
      try{
        const zip = new JSZip();
        const pages = await pdfToImagesCommon(file, async (i, blob)=>{ zip.file(`page-${i}.${fmtSel.value==='image/png'?'png':'jpg'}`, blob); }, pct=> setProgress(prog, pct));
        const zipBlob = await zip.generateAsync({type:'blob'});
        const a=Object.assign(document.createElement('a'),{href:URL.createObjectURL(zipBlob),download:`${file.name.replace(/\.pdf$/i,'') || 'images'}.zip`});
        document.body.appendChild(a); a.click(); URL.revokeObjectURL(a.href); a.remove();
        setProgress(prog, null); toast(`${pages} page(s) zipped & downloaded.`);
      }catch(e){ console.error(e); toast('ZIP failed.'); setProgress($('#imgProg'), null); }
      finally{ setBusy(btn,false); }
    };

    // Consent & AdSense
    const AD_CLIENT = 'YOUR-ADSENSE-CLIENT-ID'; // e.g., ca-pub-XXXXXXXXXXXX
    function loadAds(){
      if(!AD_CLIENT || AD_CLIENT.includes('YOUR-')) return;
      const s=document.createElement('script');
      s.async=true; s.src=`https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=${AD_CLIENT}`;
      s.crossOrigin='anonymous'; document.head.appendChild(s);
      ['ad-top','ad-mid'].forEach(id=>document.getElementById(id)?.classList.remove('hidden'));
      (window.adsbygoogle=window.adsbygoogle||[]).push({});
      (window.adsbygoogle=window.adsbygoogle||[]).push({});
    }

    const consent = localStorage.getItem('cookieConsent');
    const banner = $('#cookie');
    if(!consent){ banner.classList.add('show'); } else if(consent==='accepted'){ loadAds(); }
    $('#cookie-accept').onclick=()=>{ localStorage.setItem('cookieConsent','accepted'); banner.classList.remove('show'); loadAds(); };
    $('#cookie-decline').onclick=()=>{ localStorage.setItem('cookieConsent','declined'); banner.classList.remove('show'); };
  </script>

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"SoftwareApplication",
    "name":"Free PDF Tools",
    "applicationCategory":"UtilitiesApplication",
    "operatingSystem":"Web",
    "url":"https://YOURDOMAIN.com/",
    "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},
    "featureList":[
      "Merge PDF files online",
      "Split PDF by page range",
      "Compress PDF size",
      "Convert PDF to JPG/PNG"
    ]
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"Do you upload or store my files?","acceptedAnswer":{"@type":"Answer","text":"No. Processing happens locally in your browser. Files never leave your device."}},
      {"@type":"Question","name":"Is this PDF editor free?","acceptedAnswer":{"@type":"Answer","text":"Yes, the merge, split, compress, and convert tools are free with no signup."}},
      {"@type":"Question","name":"Which platforms are supported?","acceptedAnswer":{"@type":"Answer","text":"Any modern browser on Windows, macOS, Linux, and ChromeOS."}}
    ]
  }
  </script>
</body>
</html>

